'###########################################################################
'Test Tool/Version          : Selenium WebDriver
'Test Tool Settings         : N.A.
'Application Automated      : CXConnect
'Author                     : Cognizant
'Date Created               : 7/14/2015
'############################################################################
'Function to include Function Library files

Private Sub IncludeFileVbs (ByVal FileName)
	Const ForReading = 1
	Dim fso: set fso = CreateObject("Scripting.FileSystemObject")
	Dim f: set f = fso.OpenTextFile(FileName, ForReading)
	Dim s: s = f.ReadAll()
	ExecuteGlobal s
End Sub

' ----------------------------------------------------
' Main Test Function: This get call first of all.
' Debug - Boolean. Equals to false if running in [Test Mode] : reporting to Application Lifecycle Management
' CurrentTestSet - [OTA COM Library].TestSet.
' CurrentTSTest - [OTA COM Library].TSTest.
' CurrentRun - [OTA COM Library].Run.
' ----------------------------------------------------
Sub Test_Main(Debug, CurrentTestSet, CurrentTSTest, CurrentRun)
  ' "On Error Resume Next" statement suppresses run-time script errors.
  On Error Resume Next
  ' clear output window
  TDOutput.Clear
  Dim objWSH, objUserVariables, runStatus, strProjectPath, strVAPIXPLibPath
  'To include the LibraryFunction.vbs Function Library
  Set objWSH =  CreateObject("WScript.Shell")
  Set objUserVariables = objWSH.Environment("SYSTEM")
  strProjectPath =  objUserVariables("TEST_WORKSPACE")
'msgbox strProjectPath
  strVAPIXPLibPath =  strProjectPath & "\Resources\ALM_Connect_Project.vbs"
'msgbox strVAPIXPLibPath
  IncludeFileVbs (strVAPIXPLibPath)
  Set objWSH = NOTHING
  If Not Debug Then
     'Below function call is to Execute the Selenium script And Attach the result zip file after the execution completes
     runStatus = executeScriptandAttachResult(Debug, CurrentTSTest, CurrentRun, TDHelper, CurrentTestSet)
     'msgbox "Status in script"&runStatus
     'Update the status of VAPI script in test lab

     If runStatus <> "" Then
       CurrentRun.Status = runStatus
       CurrentTSTest.Status = runStatus
     Else
       CurrentRun.Status = "Not Completed"
       CurrentTSTest.Status = "Not Completed"
     End If

  End If

End Sub